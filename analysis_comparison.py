#!/usr/bin/env python3
"""
ì„¸ ê°€ì§€ ë¶„ì„ ëª¨ë¸ ë¹„êµ ë° ì„±ëŠ¥ í‰ê°€ ë„êµ¬
"""
import json
import logging
from typing import Dict, List
from datetime import datetime, timedelta
import random

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

class TradingModelComparator:
    """ê±°ë˜ ëª¨ë¸ ë¹„êµ ë¶„ì„ê¸°"""
    
    def __init__(self):
        self.models = {
            "technical_only": "12ê°€ì§€ ê¸°ìˆ ì  ë¶„ì„ë§Œ",
            "ai_only": "Gemini AI ì¶”ì²œë§Œ", 
            "hybrid": "ê¸°ìˆ ì  ë¶„ì„ + AI ì¢…í•©íŒë‹¨ (í˜„ì¬)"
        }
    
    def compare_models(self) -> Dict:
        """ì„¸ ëª¨ë¸ì˜ ì¥ë‹¨ì  ë¹„êµ"""
        
        comparison = {
            "technical_only": {
                "name": "ğŸ“Š ê¸°ìˆ ì  ë¶„ì„ ì „ìš© ëª¨ë¸",
                "description": "12ê°€ì§€ ê¸°ìˆ ì§€í‘œë¡œë§Œ íŒë‹¨",
                "advantages": [
                    "âœ… ë¹ ë¥¸ ë¶„ì„ ì†ë„ (API í˜¸ì¶œ ì—†ìŒ)",
                    "âœ… ì¼ê´€ëœ íŒë‹¨ ê¸°ì¤€ (ê°ì • ë°°ì œ)",
                    "âœ… ë¹„ìš© ë¬´ë£Œ (API ë¹„ìš© ì—†ìŒ)",
                    "âœ… ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ì— ê°•í•¨",
                    "âœ… ë°±í…ŒìŠ¤íŒ… ìš©ì´ (ê·œì¹™ ê¸°ë°˜)",
                    "âœ… íˆ¬ëª…í•œ ì˜ì‚¬ê²°ì • ê³¼ì •"
                ],
                "disadvantages": [
                    "âŒ ì‹œì¥ ë‰´ìŠ¤/ì´ë²¤íŠ¸ ë°˜ì˜ ë¶ˆê°€",
                    "âŒ ë³µí•©ì  ìƒí™© íŒë‹¨ í•œê³„",
                    "âŒ ê¸‰ë³€í•˜ëŠ” ì‹œì¥ì— ê²½ì§ì  ëŒ€ì‘", 
                    "âŒ False Signal í•„í„°ë§ ì–´ë ¤ì›€",
                    "âŒ ìƒˆë¡œìš´ íŒ¨í„´ í•™ìŠµ ë¶ˆê°€"
                ],
                "best_for": "ì•ˆì •ì ì´ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì‹œì¥ í™˜ê²½",
                "risk_level": "MEDIUM",
                "speed": "âš¡ ë§¤ìš° ë¹ ë¦„",
                "cost": "ğŸ’° ë¬´ë£Œ",
                "accuracy_estimate": "65-75%"
            },
            
            "ai_only": {
                "name": "ğŸ¤– AI ì „ìš© ëª¨ë¸",
                "description": "Gemini AIê°€ ëª¨ë“  íŒë‹¨",
                "advantages": [
                    "âœ… ë³µí•©ì  ìƒí™© ì¢…í•© íŒë‹¨",
                    "âœ… ë‰´ìŠ¤/ì´ë²¤íŠ¸ ì˜í–¥ ê³ ë ¤ ê°€ëŠ¥",
                    "âœ… íŒ¨í„´ í•™ìŠµ ë° ì ì‘",
                    "âœ… ì§ê´€ì  ì‹œì¥ ê°ê°",
                    "âœ… ìƒˆë¡œìš´ ì‹œì¥ ìƒí™© ëŒ€ì‘"
                ],
                "disadvantages": [
                    "âŒ API ì˜ì¡´ì„± (ì¥ì•  ìœ„í—˜)",
                    "âŒ ì‘ë‹µ ì†ë„ ëŠë¦¼ (2-5ì´ˆ)",
                    "âŒ ì¼ê´€ì„± ë¶€ì¡± (ê°™ì€ ì…ë ¥ ë‹¤ë¥¸ ì¶œë ¥)",
                    "âŒ íŒë‹¨ ê·¼ê±° ë¶ˆíˆ¬ëª…",
                    "âŒ API ë¹„ìš© ë°œìƒ (ì›” 1500íšŒ ì œí•œ)",
                    "âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ ê±°ë˜ ì¤‘ë‹¨"
                ],
                "best_for": "ë³€ë™ì„±ì´ í° ë‰´ìŠ¤ ê¸°ë°˜ ì‹œì¥",
                "risk_level": "HIGH", 
                "speed": "ğŸŒ ëŠë¦¼ (2-5ì´ˆ)",
                "cost": "ğŸ’° ë¬´ë£Œ (í•œë„ ë‚´)",
                "accuracy_estimate": "70-85%"
            },
            
            "hybrid": {
                "name": "ğŸ”„ í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸ (í˜„ì¬)",
                "description": "12ê°€ì§€ ë¶„ì„ + AI ì¢…í•©íŒë‹¨",
                "advantages": [
                    "âœ… ê¸°ìˆ ì  ì •í™•ì„± + AI ì§ê´€ë ¥",
                    "âœ… ë‹¤ì¸µì  ê²€ì¦ (ì´ì¤‘ ì•ˆì „ì¥ì¹˜)",
                    "âœ… False Signal íš¨ê³¼ì  í•„í„°ë§",
                    "âœ… ì‹œì¥ ë‰´ìŠ¤ + ê¸°ìˆ ì§€í‘œ ëª¨ë‘ ê³ ë ¤",
                    "âœ… AI ì‹¤íŒ¨ ì‹œ ê¸°ìˆ ì  ë¶„ì„ fallback",
                    "âœ… ì‹ ë¢°ë„ ì ìˆ˜ ì œê³µ"
                ],
                "disadvantages": [
                    "âŒ ë¶„ì„ ì‹œê°„ ê°€ì¥ ì˜¤ë˜ ê±¸ë¦¼",
                    "âŒ ì‹œìŠ¤í…œ ë³µì¡ë„ ë†’ìŒ",
                    "âŒ API ì˜ì¡´ì„± (ë¶€ë¶„ì )",
                    "âŒ ë””ë²„ê¹… ì–´ë ¤ì›€"
                ],
                "best_for": "ëª¨ë“  ì‹œì¥ í™˜ê²½ (ë²”ìš©ì„±)",
                "risk_level": "MEDIUM-LOW",
                "speed": "ğŸš¶ ë³´í†µ (3-7ì´ˆ)",
                "cost": "ğŸ’° ë¬´ë£Œ (í•œë„ ë‚´)",
                "accuracy_estimate": "75-90%"
            }
        }
        
        return comparison
    
    def recommend_optimal_model(self) -> Dict:
        """ìµœì  ëª¨ë¸ ì¶”ì²œ"""
        
        recommendations = {
            "current_best": "hybrid",
            "reasoning": [
                "ğŸ¯ **í˜„ì¬ ìµœì **: í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸",
                "",
                "**ì„ íƒ ì´ìœ :**",
                "1. **ì•ˆì •ì„±**: AI ì‹¤íŒ¨ ì‹œ ê¸°ìˆ ì  ë¶„ì„ìœ¼ë¡œ fallback",
                "2. **ì •í™•ì„±**: ë‘ ë°©ì‹ì˜ ì¥ì ì„ ê²°í•©í•´ ê°€ì¥ ë†’ì€ ì •í™•ë„",
                "3. **ì‹ ë¢°ë„**: AIê°€ ì‹ ë¢°ë„ ì ìˆ˜ë¥¼ ì œê³µí•´ ìœ„í—˜ ê´€ë¦¬ ê°€ëŠ¥",
                "4. **ìœ ì—°ì„±**: ë‹¤ì–‘í•œ ì‹œì¥ ìƒí™©ì— ì ì‘ ê°€ëŠ¥",
                "",
                "**ê°œì„  ì œì•ˆ:**",
                "ğŸ“ˆ **ë‹¨ê³„ì  ìµœì í™” ì „ëµ**"
            ],
            
            "optimization_strategy": {
                "phase_1": {
                    "name": "ğŸ”§ í˜„ì¬ í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸ ìµœì í™”",
                    "actions": [
                        "AI ì‹ ë¢°ë„ ì„ê³„ê°’ ì¡°ì • (í˜„ì¬: 6ì )",
                        "ê¸°ìˆ ì  ë¶„ì„ ê°€ì¤‘ì¹˜ ìµœì í™”",
                        "Fallback ë¡œì§ ê°œì„ "
                    ],
                    "duration": "1-2ì£¼",
                    "expected_improvement": "5-10%"
                },
                
                "phase_2": {
                    "name": "ğŸ“Š ì„±ê³¼ ê¸°ë°˜ ì ì‘í˜• ì‹œìŠ¤í…œ",
                    "actions": [
                        "ì‹¤ì‹œê°„ ì„±ê³¼ ì¶”ì ìœ¼ë¡œ ëª¨ë¸ ì„ íƒ",
                        "ì‹œì¥ ìƒí™©ë³„ ìµœì  ëª¨ë¸ ìë™ ì „í™˜",
                        "AI vs ê¸°ìˆ ë¶„ì„ ì„±ê³¼ ë¹„êµ"
                    ],
                    "duration": "2-4ì£¼", 
                    "expected_improvement": "10-15%"
                },
                
                "phase_3": {
                    "name": "ğŸ¤– ìì²´ í•™ìŠµí˜• AI ëª¨ë¸",
                    "actions": [
                        "ê³¼ê±° ê±°ë˜ ë°ì´í„°ë¡œ ìì²´ AI ëª¨ë¸ í›ˆë ¨",
                        "Gemini + ìì²´ëª¨ë¸ ì•™ìƒë¸”",
                        "ì‹¤ì‹œê°„ ëª¨ë¸ ì„±ëŠ¥ ìµœì í™”"
                    ],
                    "duration": "4-8ì£¼",
                    "expected_improvement": "15-25%"
                }
            },
            
            "immediate_action": {
                "recommendation": "í˜„ì¬ í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸ ìœ ì§€í•˜ë˜ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ê°•í™”",
                "reason": "ì´ë¯¸ ìµœì ì˜ ê· í˜•ì ì— ìˆìœ¼ë©°, ì¶”ê°€ ë°ì´í„° ìˆ˜ì§‘ìœ¼ë¡œ ê°œì„  ê°€ëŠ¥"
            }
        }
        
        return recommendations
    
    def generate_performance_simulation(self) -> Dict:
        """ê°€ìƒ ì„±ê³¼ ì‹œë®¬ë ˆì´ì…˜"""
        
        # ê°€ìƒ ì‹œë‚˜ë¦¬ì˜¤ë³„ ì˜ˆìƒ ì„±ê³¼
        scenarios = {
            "bull_market": {
                "name": "ğŸ‚ ê°•ì„¸ì¥ (ìƒìŠ¹ íŠ¸ë Œë“œ)",
                "technical_only": {"accuracy": 70, "avg_return": 2.1, "risk_score": 6},
                "ai_only": {"accuracy": 85, "avg_return": 3.2, "risk_score": 8}, 
                "hybrid": {"accuracy": 88, "avg_return": 3.0, "risk_score": 5}
            },
            
            "bear_market": {
                "name": "ğŸ» ì•½ì„¸ì¥ (í•˜ë½ íŠ¸ë Œë“œ)", 
                "technical_only": {"accuracy": 65, "avg_return": -0.5, "risk_score": 7},
                "ai_only": {"accuracy": 60, "avg_return": -1.2, "risk_score": 9},
                "hybrid": {"accuracy": 75, "avg_return": 0.2, "risk_score": 5}
            },
            
            "sideways_market": {
                "name": "â†”ï¸ íš¡ë³´ì¥ (ë°•ìŠ¤ê¶Œ)",
                "technical_only": {"accuracy": 78, "avg_return": 1.8, "risk_score": 4},
                "ai_only": {"accuracy": 72, "avg_return": 1.5, "risk_score": 6},
                "hybrid": {"accuracy": 82, "avg_return": 2.2, "risk_score": 4}
            },
            
            "volatile_market": {
                "name": "âš¡ ê³ ë³€ë™ì„±ì¥",
                "technical_only": {"accuracy": 58, "avg_return": 0.8, "risk_score": 9},
                "ai_only": {"accuracy": 75, "avg_return": 2.8, "risk_score": 7},
                "hybrid": {"accuracy": 80, "avg_return": 2.5, "risk_score": 6}
            }
        }
        
        return scenarios
    
    def create_recommendation_summary(self) -> str:
        """ìµœì¢… ì¶”ì²œ ìš”ì•½"""
        
        summary = """
ğŸ¯ **ìµœì¢… ê²°ë¡ : í˜„ì¬ í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸ì´ ìµœì **

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ† **í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸ì˜ ìš°ìˆ˜ì„±**                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… ì „ ì‹œì¥ í™˜ê²½ì—ì„œ ê°€ì¥ ì•ˆì •ì ì¸ ì„±ê³¼                     â”‚
â”‚  âœ… AI ì‹¤íŒ¨ ì‹œ ê¸°ìˆ ì  ë¶„ì„ìœ¼ë¡œ ì•ˆì „í•œ fallback              â”‚  
â”‚  âœ… ì´ì¤‘ ê²€ì¦ìœ¼ë¡œ False Signal ìµœì†Œí™”                       â”‚
â”‚  âœ… ì‹ ë¢°ë„ ì ìˆ˜ë¡œ ìœ„í—˜ ê´€ë¦¬ ê°€ëŠ¥                           â”‚
â”‚  âœ… 75-90% ì˜ˆìƒ ì •í™•ë„ (ê°€ì¥ ë†’ìŒ)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š **ì‹œë‚˜ë¦¬ì˜¤ë³„ ì„±ê³¼ ì˜ˆì¸¡:**
â€¢ ê°•ì„¸ì¥: í•˜ì´ë¸Œë¦¬ë“œ 88% vs AI 85% vs ê¸°ìˆ ë¶„ì„ 70%
â€¢ ì•½ì„¸ì¥: í•˜ì´ë¸Œë¦¬ë“œ 75% vs ê¸°ìˆ ë¶„ì„ 65% vs AI 60% 
â€¢ íš¡ë³´ì¥: í•˜ì´ë¸Œë¦¬ë“œ 82% vs ê¸°ìˆ ë¶„ì„ 78% vs AI 72%
â€¢ ë³€ë™ì¥: í•˜ì´ë¸Œë¦¬ë“œ 80% vs AI 75% vs ê¸°ìˆ ë¶„ì„ 58%

ğŸš€ **ê°œì„  ë°©í–¥:**
1ï¸âƒ£ í˜„ì¬ í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë¸ ìµœì í™” (AI ì‹ ë¢°ë„ ì„ê³„ê°’ ì¡°ì •)
2ï¸âƒ£ ì‹¤ì‹œê°„ ì„±ê³¼ ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ëª¨ë¸ë³„ ì„±ëŠ¥ ì¶”ì 
3ï¸âƒ£ ì¥ê¸°ì ìœ¼ë¡œ ìì²´ AI ëª¨ë¸ ê°œë°œ ê²€í† 

ğŸ’¡ **ì¦‰ì‹œ ì‹¤í–‰ ê¶Œì¥ì‚¬í•­:**
- âœ… í˜„ì¬ ì‹œìŠ¤í…œ ìœ ì§€ (ì´ë¯¸ ìµœì  êµ¬ì¡°)
- âœ… AI ì‹ ë¢°ë„ ì„ê³„ê°’ 6â†’7ì  ìƒí–¥ ì¡°ì • ê³ ë ¤  
- âœ… ì„±ê³¼ ì¶”ì  ì‹œìŠ¤í…œ ê°•í™” (ì´ë¯¸ êµ¬í˜„ë¨)
- âœ… ë°±í…ŒìŠ¤íŒ…ìœ¼ë¡œ ìµœì  íŒŒë¼ë¯¸í„° ì°¾ê¸°
"""
        
        return summary

def main():
    """ë©”ì¸ í•¨ìˆ˜"""
    comparator = TradingModelComparator()
    
    print("ğŸ” CoinButler ê±°ë˜ ëª¨ë¸ ë¹„êµ ë¶„ì„")
    print("=" * 60)
    
    # ëª¨ë¸ ë¹„êµ
    comparison = comparator.compare_models()
    
    for model_key, model_data in comparison.items():
        print(f"\n{model_data['name']}")
        print("-" * 40)
        print(f"ğŸ“ {model_data['description']}")
        print(f"ğŸ¯ ìµœì  í™˜ê²½: {model_data['best_for']}")
        print(f"âš¡ ì†ë„: {model_data['speed']}")
        print(f"ğŸ’° ë¹„ìš©: {model_data['cost']}")
        print(f"ğŸ² ì˜ˆìƒ ì •í™•ë„: {model_data['accuracy_estimate']}")
        print(f"âš ï¸ ìœ„í—˜ë„: {model_data['risk_level']}")
        
        print("\nâœ… ì¥ì :")
        for advantage in model_data['advantages']:
            print(f"  {advantage}")
            
        print("\nâŒ ë‹¨ì :")  
        for disadvantage in model_data['disadvantages']:
            print(f"  {disadvantage}")
    
    # ì¶”ì²œì‚¬í•­
    print("\n" + "=" * 60)
    recommendation = comparator.recommend_optimal_model()
    print(comparator.create_recommendation_summary())
    
    # ì„±ê³¼ ì‹œë®¬ë ˆì´ì…˜
    print("\nğŸ“Š **ì‹œì¥ ì‹œë‚˜ë¦¬ì˜¤ë³„ ì˜ˆìƒ ì„±ê³¼**")
    print("-" * 60)
    scenarios = comparator.generate_performance_simulation()
    
    for scenario_key, scenario_data in scenarios.items():
        print(f"\n{scenario_data['name']}")
        print("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
        print("â”‚    ëª¨ë¸     â”‚ ì •í™•ë„  â”‚ ìˆ˜ìµë¥   â”‚ ìœ„í—˜ë„  â”‚")
        print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
        
        for model in ['technical_only', 'ai_only', 'hybrid']:
            model_name = {'technical_only': 'ê¸°ìˆ ë¶„ì„', 'ai_only': 'AIì „ìš©', 'hybrid': 'í•˜ì´ë¸Œë¦¬ë“œ'}[model]
            data = scenario_data[model]
            print(f"â”‚ {model_name:11} â”‚ {data['accuracy']:6}% â”‚ {data['avg_return']:6.1f}% â”‚ {data['risk_score']:6}/10 â”‚")
        
        print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")

if __name__ == "__main__":
    main()
